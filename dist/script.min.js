"use strict";const{isArray:A}=Array;const _=a=>typeof a==='number';var c=document.querySelector('.canvas'),d=document.querySelector('.reset'),B=document.querySelector('.generate'),f=document.querySelector('.undo'),g=document.querySelector('.setBtn'),h=c.getContext('2d'),I=document.querySelector('.design'),j=document.querySelector('.user-design'),k=document.querySelector('.save'),l=document.querySelector('.popup_saved'),m=document.querySelector('.curve-input-container'),N=document.querySelector('.btn-close'),o=document.querySelector('.copy'),p=localStorage.getItem('canvasArray'),q=e=>{aE();aI();aF();aA(e)};let r='1';let s='#000000';let t;let u;let x;let y;let X=-1;let Y=[];let z=!1;function aA(C){h&&(h.beginPath(),h.strokeStyle=s,h.lineWidth=+r,h.moveTo(x,y),h.lineTo(C.offsetX,C.offsetY),h.stroke());}function aB(n){return _(n)}function aC(){Y.length===0?I.value='[ ]':I.value=JSON.stringify(Y);}function aD(){var _a=Y[Y.length-1];if(aB(_a)){for(let i=0;i<4;i++)Y.pop();;X-=4}else A(_a)&&(Y.pop(),X--);};function aE(){h===null||h===void 0?void 0:h.clearRect(0,0,c.width,c.height)};function aF(){let i=0;if(h){h.beginPath();h.strokeStyle='#000000';h.lineWidth=1;while (i<Y.length) {let D=Y[i];let _b=Y[i+1];if(aB(D)&&aB(_b)){h.moveTo(+D,+_b);h.lineTo(+Y[i+2],+Y[i+3]);i+=4}else if(A(D)){h.moveTo(D[0],D[1]);h.quadraticCurveTo(D[2],D[3],D[4],D[5]);i++}else{if(!(aB(D)||aB(_b))&&!A(_b)){h.stroke();h.beginPath();h.strokeStyle=`${D}`;h.lineWidth=+_b;i+=2}else{Math.sign(+D)?(h.stroke(),h.beginPath(),h.lineWidth=+D,i++):(h.stroke(),h.beginPath(),h.strokeStyle=`${D}`,i++);}}};h.stroke()}};function aG(){var _A=document.querySelector('.space'),_B=document.createRange(),_c=window.getSelection();let i=0;if(_A){_A.innerHTML='';_A.innerHTML+=`<div>const canvas = document.querySelector(\'canvas\');</div><div>const ctx = canvas.getContext(\'2d\');</div><div>ctx.beginPath();</div><div>ctx.strokeStyle = '#000000';</div><div>ctx.lineWidth = 1;</div>`;while (i<Y.length) {let E=Y[i];let aK=Y[i+1];if(aB(E)&&aB(aK)){_A.innerHTML+=`<div>ctx.moveTo(${E}, ${aK});</div>`;_A.innerHTML+=`<div>ctx.lineTo(${Y[i+2]}, ${Y[i+3]});</div>`;i+=4}else if(A(E)){_A.innerHTML+=`<div>ctx.moveTo(${E[0]}, ${E[1]});</div>`;_A.innerHTML+=`<div>ctx.quadraticCurveTo(${E[2]}, ${E[3]}, ${E[4]}, ${E[5]});</div>`;i++}else{if(!(aB(E)||aB(aK))&&!A(aK)){_A.innerHTML+=`<div>ctx.stroke();</div><div>ctx.beginPath();</div><div>ctx.strokeStyle = '${E}';</div>`;_A.innerHTML+=`<div>ctx.lineWidth = '${aK}';</div>`;i+=2}else{Math.sign(+E)?(_A.innerHTML+=`<div>ctx.stroke();</div><div>ctx.beginPath();</div><div>ctx.lineWidth = '${E}';</div>`,i++):(_A.innerHTML+=`<div>ctx.stroke();</div><div>ctx.beginPath();</div><div>ctx.strokeStyle = '${E}';</div>`,i++);}}};_A.innerHTML+='<div>ctx.stroke();</div>';_c===null||_c===void 0?void 0:_c.removeAllRanges();_B.selectNodeContents(_A);_c===null||_c===void 0?void 0:_c.addRange(_B)}};function aH(aL,...aM){if(aL==='def'){var _C=window.innerHeight,_d=window.innerWidth;c.width=(_d/100)*70;c.height=(_C/100)*72.5}else{c.width=aM[0];c.height=aM[1]}}function aI(){var aN=2.5*parseFloat(getComputedStyle(document.documentElement).fontSize);t=+document.querySelector('.width').value||c.width;u=+document.querySelector('.height').value||c.height;if(h){h.beginPath();h.strokeStyle='#AAAAAA';h.lineWidth=1;for(let x=0;x<=t;x+=aN){h.moveTo(x,0);h.lineTo(x,u)}for(let y=0;y<=u;y+=aN){h.moveTo(0,y);h.lineTo(t,y)}h.stroke()}};function aJ(){var aO=document.querySelector('.curveX'),aP=document.querySelector('.curveY'),aQ=Y[Y.length-1];let _D=[];if(Y.length!==0){if(aB(aQ)){for(let i=0;i<4;i++)_D.push(Y.pop());;X=X-3;_D.reverse()};if(A(aQ)){for(let i=0;i<4;i++)_D.push(aQ[i]);;Y.pop()};_D.push((c.width/100)* +aO.value);_D.push((c.height/100)* +aP.value);Y.push(_D)}};aH('def');aI();p!==null&&(Y=JSON.parse(p),X+=Y.length,aF());aC();window.addEventListener('resize',e=>{t=+document.querySelector('.width').value;u=+document.querySelector('.height').value;!(t&&u)?aH('def'):aH('custom',t,u);aE();aI();aF()});window.addEventListener('beforeunload',e=>{(localStorage.getItem('canvasArray')!==JSON.stringify(Y)&&!z)&&(e.preventDefault(),z=!0)});c.addEventListener('contextmenu',e=>e.preventDefault());c.addEventListener('pointerdown',e=>{var aR=document.querySelector('.stroke-width').value,aS=document.querySelector('.color').value;aS!==s&&(s=aS,X++,Y[X]=s);(aR&&aR!==r)&&(r=aR,X++,Y[X]=r);x=Math.round(e.offsetX);y=Math.round(e.offsetY);X++;Y[X]=x;X++;Y[X]=y;c.addEventListener('pointermove',q)});c.addEventListener('pointerup',e=>{let a=Math.round(e.offsetX);let b=Math.round(e.offsetY);aE();aI();aF();c.removeEventListener('pointermove',q);X++;Y[X]=a;X++;Y[X]=b;h&&(h.beginPath(),h.strokeStyle=s,h.lineWidth=+r,h.moveTo(x,y),h.lineTo(a,b),h.stroke());;aC()});f===null||f===void 0?void 0:f.addEventListener('click',()=>{aE();aD();aI();aF();aC()});B===null||B===void 0?void 0:B.addEventListener('click',()=>aG());d===null||d===void 0?void 0:d.addEventListener('click',()=>{aE();aI();Y=[];X=-1;localStorage.removeItem('canvasArray');r='1';s='#000000';aC()});g===null||g===void 0?void 0:g.addEventListener('click',()=>{t=+document.querySelector('.width').value;u=+document.querySelector('.height').value;aH('custom',t,u);aI();aF()});k===null||k===void 0?void 0:k.addEventListener('click',()=>{localStorage.setItem('canvasArray',JSON.stringify(Y));X=X+Y.length;l.classList.add('show');N===null||N===void 0?void 0:N.addEventListener('click',()=>{clearTimeout(aT);l.classList.remove('show')});var aT=setTimeout(()=>l.classList.remove('show'),2300)});j===null||j===void 0?void 0:j.addEventListener('click',()=>{aE();Y=JSON.parse(document.querySelector('.design').value);aI();aF();aC()});m.addEventListener('input',e=>{var aU=e.target,aV=aU.value;if(aU.classList.contains('curveX')){var aW=document.querySelector('.curveXupdate');aW.innerHTML=aV}else{var _e=document.querySelector('.curveYupdate');_e.innerHTML=aV};aE();aI();aJ();aF();aC()});o===null||o===void 0?void 0:o.addEventListener('click',()=>navigator.clipboard.writeText(document.querySelector('.design').value));